var storeUtil=function(){function e(e){return e=e.toLowerCase(),e=e.split("//"),e=e.length>1?e[1]:e[0],e=e.replace("www.","").split("/")[0].split("?")[0]}function t(t,r,o){if(o=o||!1,r=e(r),t===r)return!0;if(o){var n=t.indexOf(r);if(n<0)return!1;if("."!=t[n-1])return!1;if(t.substr(n)==r)return!0}return!1}function r(r,o,n){if(!r||0===r.length)return null;o=o||window.location.host;var a=e(o),i=!1;r.forEach(function(e){if(!i&&t(a,e.url,!1))return i=!0,n(e),!1;if(!i&&e.url_alternative&&e.url_alternative.length>3)for(var r=e.url_alternative.split(","),o=0;o<r.length;o++)if(t(a,r[o]),!1)return i=!0,n(e),!1}),i||r.forEach(function(e){if(!i&&t(a,e.url,!0))return i=!0,n(e),!1;if(!i&&e.url_alternative&&e.url_alternative.length>3)for(var r=e.url_alternative.split(","),o=0;o<r.length;o++)if(t(a,r[o],!0))return n(e),!1})}function o(e,t){t=t||!0,t?Storage.set(storeActiveStorageName+e,(new Date).getTime()):Storage.remove(storeActiveStorageName+e),debug&&console.log("активация шопа "+storeActiveStorageName+e+" "+Storage.get(storeActiveStorageName+e))}function n(){var e=document.querySelector(".ad-detect"),t=!!e&&e.getAttribute("data-store-route"),r=!!e&&"none"!==e.style.display;if(debug&&console.log("картинка для goto для шоп "+(e?" yes ":" no ")+t+" видимая "+r),e&&t&&r){o(t,!0);var n=setInterval(function(){e=document.querySelector(".ad-detect"),r=!!e&&"none"!==e.style.display,debug&&console.log("проверка видимости картинки на goto "+r),r||(o(t,!1),clearInterval(n))},500)}}function a(e){var t=Storage.get(storeActiveStorageName+e),r=void 0!==t&&(new Date).getTime()-t<60*storeActiveInterval*1e3;return debug&&console.log(storeActiveStorageName+e,t,r,((new Date).getTime()-t)/6e4),r}function i(e,t){t=t||!0;var r=storePopupClosedStorageName+e;t?Storage.set(r,(new Date).getTime()):Storage.remove(r),debug&&console.log("статус попап шопа "+r+" "+Storage.get(r))}function l(e){var t=storePopupClosedStorageName+e,r=Storage.get(t),o=null!==r&&(new Date).getTime()-r<60*storePopupCloseInterval*1e3;return debug&&console.log("Cтатус попап шопа "+t+" закрыт - "+o),o}return{findShop:r,analizeActivated:n,isActivated:a,setPopupClosed:i,popupClosed:l}}();