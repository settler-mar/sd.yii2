var searchAnalize=function(){function e(e){return debug&&console.log("display on search "+(void 0===e||null===e||1==e||2==e)),void 0===e||null===e||1==e||2==e}function t(e,t,r){if(t instanceof Array){for(var s=0;s<t.length;s++)if(e[t[s]]===r)return!0}else if("number"==typeof t)return e[t]===r;return!1}function r(t){if(e(t.display)){var r=this,n=r.engine,a=r.el;s(t,a,n)}}function s(e,t,r){if(!(t.querySelectorAll(".sd_link_finder").length>0)){var s=document.createElement("div");message=utils.replaceTemplate(lg("searchtext {{cashback}}"),{cashback:utils.makeCashback(e.displayed_cashback,e.currency,e.action_id)});var n="";n=usersData&&usersData.user?siteUrl+utils.href("goto/store:"+e.uid):siteUrl+utils.href("stores/"+e.store_route+"#login"),s.innerHTML="<a data-store='"+e.store_route+"' href='"+n+"'target='_blank' class='sd_link_finder'>"+favicon+message,s.id="secretdiscounter-search",s.className="secretdiscounter-search",s.setAttribute("style",r.styles),t.prepend(s),utils.makeHrefs(t)}}function n(){if(repeatTimes--,!(repeatTimes<=0))return document.querySelectorAll(".sd_link_finder").length>0?void setTimeout(n,1e3):void analizPage()}function a(){var e=location.hostname.split(".");for(key in c){var s=c[key];if(t(e,s.location_href_index,s.location_href)){var a=document.querySelectorAll(s.analiseHREF);if(0==a.length)return;debug&&console.log(a);for(var i=0;i<a.length;i++){var l,o=a[i],u=o.closest(s.closest);s.adcDetect&&s.adcDetect(u)||(s.byText?l=o.innerText:(l=o.href.split("//"),2==l.length&&(l=l[1]),l=l.split("/"),l=l[0].split("?"),l=l[0]),storeUtil.findShop(storageDataStores.stores,l,r.bind({engine:s,el:u})))}repeatTimes===!1&&(repeatTimes=s.repeat),setTimeout(n,1e3)}}}function i(){var e=document.querySelector(c.yandex.dom_change_selector),t=document.querySelector(c.yandex.search_selector);e&&t&&e.addEventListener("DOMSubtreeModified",u)}var l=null,o=null,c={google:{search_selector:"#lst-ib",location_href:"google",location_href_index:1,result_selector:"#res",result_first_item:1,repeat:1,styles:"",analiseHREF:"#res h3 a[href]",closest:"div.g"},bing:{search_selector:"#sb_form_q",location_href:"bing",location_href_index:1,result_selector:"#b_results",result_first_item:0,repeat:1,styles:"",analiseHREF:"#b_results h2 a[href]",closest:"li.b_algo"},yandex:{search_selector:"div.serp-header__main input.input__control",location_href:"yandex",location_href_index:[0,1],result_selector:".serp-list",result_first_item:0,dom_change_selector:".main .main__center .main__content",repeat:5,styles:"margin-left:-23px;",analiseHREF:".serp-list .serp-item .path a[href] b",byText:!0,closest:"li.serp-item",adcDetect:function(e){for(var t=0;t<e.attributes.length;t++){var r=e.attributes[t].name.toLocaleLowerCase();if(!(r.indexOf("data-")<0||(r=r.replace("data-",""),"cid"==r||"lognode"==r||r.length<4||r.length>6)))return!0}return!1}}},u=function(){clearTimeout(l),l=setTimeout(function(){null===o&&(o=setTimeout(function(){clearTimeout(o),o=null},8e3),a())},500)};return{analize:a,yandexHandlerSet:i}}();