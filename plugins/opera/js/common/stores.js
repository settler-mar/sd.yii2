var storeUtil=function(){function l(e){return e=(e=1<(e=(e=e.toLowerCase()).split("//")).length?e[1]:e[0]).replace("www.","").split("/")[0].split("?")[0]}function i(e,t,r){if(r=r||!1,e===(t=l(t)))return!0;if(r){var o=e.indexOf(t);if(o<0)return!1;if("."!=e[o-1])return!1;if(e.substr(o)==t)return!0}return!1}function n(e,t){(t=t||!0)?Storage.set(storeActiveStorageName+e,(new Date).getTime()):Storage.remove(storeActiveStorageName+e),debug&&console.log("активация шопа "+storeActiveStorageName+e+" "+Storage.get(storeActiveStorageName+e))}return{findShop:function r(e,t,o){if(!e||0===e.length)return null;var n=l(t=t||window.location.host),a=!1;e.forEach(function(e){if(!a&&i(n,e.url,!1))return a=!0,o(e),!1;if(!a&&e.url_alternative&&3<e.url_alternative.length)for(var t=e.url_alternative.split(","),r=0;r<t.length;r++)i(n,t[r])}),a||e.forEach(function(e){if(!a&&i(n,e.url,!0))return a=!0,o(e),!1;if(!a&&e.url_alternative&&3<e.url_alternative.length)for(var t=e.url_alternative.split(","),r=0;r<t.length;r++)if(i(n,t[r],!0))return o(e),!1})},analizeActivated:function a(){var e=document.querySelector(".ad-detect"),t=!!e&&e.getAttribute("data-store-route"),r=!!e&&"none"!==e.style.display;if(debug&&console.log("картинка для goto для шоп "+(e?" yes ":" no ")+t+" видимая "+r),e&&t&&r){n(t,!0);var o=setInterval(function(){e=document.querySelector(".ad-detect"),r=!!e&&"none"!==e.style.display,debug&&console.log("проверка видимости картинки на goto "+r),r||(n(t,!1),clearInterval(o))},500)}},isActivated:function o(e){var t=Storage.get(storeActiveStorageName+e),r=null!==t&&(new Date).getTime()-t<60*storeActiveInterval*1e3;return debug&&console.log(storeActiveStorageName+e,t,r,((new Date).getTime()-t)/6e4),r},setPopupClosed:function u(e,t){t=t||!0;var r=storePopupClosedStorageName+e;t?Storage.set(r,(new Date).getTime()):Storage.remove(r),debug&&console.log("статус попап шопа "+r+" "+Storage.get(r))},popupClosed:function g(e){var t=storePopupClosedStorageName+e,r=Storage.get(t),o=null!==r&&(new Date).getTime()-r<60*storePopupCloseInterval*1e3;return debug&&console.log("Cтатус попап шопа "+t+" закрыт - "+o),o}}}();