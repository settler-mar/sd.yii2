var searchAnalize=function(){var e=null,t=null,l={google:{search_selector:"#lst-ib",location_href:"google",location_href_index:1,result_selector:"#res",result_first_item:1,repeat:1,styles:"",analiseHREF:"#res h3 a[href]",closest:"div.g"},bing:{search_selector:"#sb_form_q",location_href:"bing",location_href_index:1,result_selector:"#b_results",result_first_item:0,repeat:1,styles:"",analiseHREF:"#b_results h2 a[href]",closest:"li.b_algo"},yandex:{search_selector:"div.serp-header__main input.input__control",location_href:"yandex",location_href_index:[0,1],result_selector:".serp-list",result_first_item:0,dom_change_selector:".main .main__center .main__content",repeat:5,styles:"margin-left:-23px;",analiseHREF:".serp-list .serp-item .path a[href] b",byText:!0,closest:"li.serp-item",adcDetect:function(e){for(var t=0;t<e.attributes.length;t++){var r=e.attributes[t].name.toLocaleLowerCase();if(!(r.indexOf("data-")<0)&&("cid"!=(r=r.replace("data-",""))&&"lognode"!=r&&!(r.length<4||6<r.length)))return!0}return!1}}};function o(e,t,r){if(t instanceof Array){for(var n=0;n<t.length;n++)if(e[t[n]]===r)return!0}else if("number"==typeof t)return e[t]===r;return!1}function c(e){if(function r(e){return debug&&console.log("display on search "+(e===undefined||null===e||1==e||2==e)),e===undefined||null===e||1==e||2==e}(e.display)){var t=this.engine;!function a(e,t,r){if(0<t.querySelectorAll(".sd_link_finder").length)return;var n=document.createElement("div");message=utils.replaceTemplate(lg("searchtext {{cashback}}"),{cashback:utils.makeCashback(e.displayed_cashback,e.currency,e.action_id)});var s="";s=usersData&&usersData.user?siteUrl+utils.href("goto/store:"+e.uid):siteUrl+utils.href("stores/"+e.store_route+"#login");n.innerHTML="<a data-store='"+e.store_route+"' href='"+s+"'target='_blank' class='sd_link_finder'>"+favicon+message,n.id="secretdiscounter-search",n.className="secretdiscounter-search",n.setAttribute("style",r.styles),t.prepend(n),utils.makeHrefs(t)}(e,this.el,t)}}function u(){repeatTimes--,repeatTimes<=0||(0<document.querySelectorAll(".sd_link_finder").length?setTimeout(u,1e3):analizPage())}function r(){var e=location.hostname.split(".");for(key in l){var t=l[key];if(o(e,t.location_href_index,t.location_href)){var r=document.querySelectorAll(t.analiseHREF);if(0==r.length)return;debug&&console.log(r);for(var n=0;n<r.length;n++){var s,a=r[n],i=a.closest(t.closest);t.adcDetect&&t.adcDetect(i)||(s=t.byText?a.innerText:(2==(s=a.href.split("//")).length&&(s=s[1]),(s=(s=s.split("/"))[0].split("?"))[0]),storeUtil.findShop(storageDataStores.stores,s,c.bind({engine:t,el:i})))}!1===repeatTimes&&(repeatTimes=t.repeat),setTimeout(u,1e3)}}}var n=function(){clearTimeout(e),e=setTimeout(function(){null===t&&(t=setTimeout(function(){clearTimeout(t),t=null},8e3),r())},500)};return{analize:r,yandexHandlerSet:function s(){var e=document.querySelector(l.yandex.dom_change_selector),t=document.querySelector(l.yandex.search_selector);e&&t&&e.addEventListener("DOMSubtreeModified",n)}}}();