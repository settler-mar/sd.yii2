var searchAnalize=function(){function e(e,t,r){if(t instanceof Array){for(var s=0;s<t.length;s++)if(e[t[s]]===r)return!0}else if("number"==typeof t)return e[t]===r;return!1}function t(e){var t=this,s=t.engine,n=t.el;r(e,n,s)}function r(e,t,r){if(!(t.querySelectorAll(".sd_link_finder").length>0)){var s=document.createElement("div");message=utils.replaceTemplate(storageDataStores.searchtext,{cashback:utils.makeCashback(e.displayed_cashback,e.currency,e.action_id),currentUrl:siteUrl+e.url,storename:utils.ucfirst(e.name)});var n="";n=usersData&&usersData.user?siteUrl+"goto/store:"+e.uid:siteUrl+"stores/"+e.store_route+"#login",s.innerHTML="<a data-store='"+e.store_route+"' href='"+n+"'target='_blank' class='sd_link_finder'>"+favicon+message,s.id="secretdiscounter-search",s.className="secretdiscounter-search",s.setAttribute("style",r.styles),t.prepend(s),utils.makeHrefs(t)}}function s(){if(repeatTimes--,!(repeatTimes<=0))return document.querySelectorAll(".sd_link_finder").length>0?void setTimeout(s,1e3):void analizPage()}function n(){var r=location.hostname.split(".");for(key in o){var n=o[key];if(e(r,n.location_href_index,n.location_href)){var a=document.querySelectorAll(n.analiseHREF);if(0==a.length)return;debug&&console.log(a);for(var i=0;i<a.length;i++){var l,c=a[i],u=c.closest(n.closest);n.adcDetect&&n.adcDetect(u)||(n.byText?l=c.innerText:(l=c.href.split("//"),2==l.length&&(l=l[1]),l=l.split("/"),l=l[0].split("?"),l=l[0]),storeUtil.findShop(storageDataStores.stores,l,t.bind({engine:n,el:u})))}repeatTimes===!1&&(repeatTimes=n.repeat),setTimeout(s,1e3)}}}function a(){var e=document.querySelector(o.yandex.dom_change_selector),t=document.querySelector(o.yandex.search_selector);e&&t&&e.addEventListener("DOMSubtreeModified",c)}var i=null,l=null,o={google:{search_selector:"#lst-ib",location_href:"google",location_href_index:1,result_selector:"#res",result_first_item:1,repeat:1,styles:"",analiseHREF:"#res h3 a[href]",closest:"div.g"},bing:{search_selector:"#sb_form_q",location_href:"bing",location_href_index:1,result_selector:"#b_results",result_first_item:0,repeat:1,styles:"",analiseHREF:"#b_results h2 a[href]",closest:"li.b_algo"},yandex:{search_selector:"div.serp-header__main input.input__control",location_href:"yandex",location_href_index:[0,1],result_selector:".serp-list",result_first_item:0,dom_change_selector:".main .main__center .main__content",repeat:5,styles:"margin-left:-23px;",analiseHREF:".serp-list .serp-item .path a[href] b",byText:!0,closest:"li.serp-item",adcDetect:function(e){for(var t=0;t<e.attributes.length;t++){var r=e.attributes[t].name.toLocaleLowerCase();if(!(r.indexOf("data-")<0||(r=r.replace("data-",""),"cid"==r||"lognode"==r||r.length<4||r.length>6)))return!0}return!1}}},c=function(){clearTimeout(i),i=setTimeout(function(){null===l&&(l=setTimeout(function(){clearTimeout(l),l=null},8e3),n())},500)};return{analize:n,yandexHandlerSet:a}}();