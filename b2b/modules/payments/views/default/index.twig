{{ use('/yii/grid/GridView') }}
{% set title = 'Платежи' %}
{{ set(this, 'title', title) }}
{% if not this.params.breadcrumbs %}
{{ set(this, 'params', this.params|merge({'breadcrumbs': []})) }}
{% endif %}
{% set breadcrumbs = this.params.breadcrumbs %}
{% set breadcrumbs = breadcrumbs|merge([title]) %}
{{ set(this, 'params', this.params|merge({'breadcrumbs': breadcrumbs})) }}
<div class="payments-index">
    <h1>{{ html.encode(this.title) }}</h1>
    {# include('_search.twig', {'model': searchModel}) #}
    <div class="col-md-12">
        Количество покупок (подтвержденных/ожидающих):
    </div>
    <div class="col-md-12">
        Кэшбэк (подтвержденный/ожидаемый):
    </div>
    <div class="col-md-12">
        Доход от друзей (подтвержденный/ожидаемый):
    </div>
    <div class="form-horizontal col-md-12" style="margin: 20px auto;">
        <div class="form-group">
            <label class="col-sm-2 control-label" for="payments_select_store">Магазин</label>
            <div class="col-sm-10">
                <select class="form-control" name="store" id="payments_select_store">
                    <option value=""></option>
                    {% for index, store in stores %}
                        <option
                            value="{{ index }}"
                            data-points='[
                            {% for point in store.points %}
                                {"id":"{{ point.point_id }}","country":"{{ point.country}}","name":"{{ point.point_name}}","address":"{{ point.address}}"}
                                {% if loop.index < loop.length %},{% endif %}
                            {% endfor %}]'

                        >{{ store.name }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="payments_select_store_point">Торговая точка</label>
            <div class="col-sm-10">
                <select class="form-control" name="store_point" id="payments_select_store_point">
                </select>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="date_range">Период</label>
            <form method="get" class="col-sm-10">
                {{ data_ranger | raw }}
            </form>
        </div>
    </div>


    {{ grid_view_widget({
            'dataProvider': dataProvider,
            'pager' : {
                'firstPageLabel' : true,
                'lastPageLabel' : true,
                'maxButtonCount':20
            },
            'filterModel': searchModel,
            'columns': [
                {'class': '\\yii\\grid\\SerialColumn'},
                'uid',
                {
                    'format':'raw',
                    'attribute':'storeName',
                    'value': table_data.store_name
                },
                'click_date',
                'action_date',
                'order_price',
                'reward',
                'cashback',
                'status',
            ],
        })
    }}
{#
'order_price',
'reward',
'cashback',
'status',
'click_date',
'action_date',
'status_updated',
'closing_date',
'cpa_id',
'additional_id',
'ref_bonus_id',
'ref_bonus',
'ref_id',
'loyalty_status',
'order_id',
'shop_percent',
'kurs',
'admin_comment',
'old_reward',
'old_order_price'
#}
</div>