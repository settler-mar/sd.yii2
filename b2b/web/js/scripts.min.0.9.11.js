function ajaxForm(t){function o(t){var o=this;form=o.form,wrap=o.wrap,t.render?(t.notyfy_class="notify_white",notification.alert(t)):(wrap.removeClass("loading"),wrap.html(t.html),ajaxForm(wrap))}function i(){var t=this;form=t.form,wrap=t.wrap,wrap.removeClass("loading"),wrap.html("<h3>Упс... Возникла непредвиденная ошибка.<h3><p>Часто это происходит в случае, если вы несколько раз подряд неверно ввели свои учетные данные. Но возможны и другие причины. В любом случае не расстраивайтесь и просто обратитесь к нашему оператору службы поддержки.</p><br><p>Спасибо.</p>"),ajaxForm(wrap)}function n(t){t.preventDefault();var n=this;if(form=n.form,wrap=n.wrap,form.yiiActiveForm&&form.yiiActiveForm("validate"),isValid=0==form.find(n.param.error_class).length,!isValid)return!1;for(required=form.find("input.required"),e=0;e<required.length;e++)if(required.eq(e).val().length<1)return!1;form.serializeObject||addSRO();var a=form.serializeObject();return form.addClass("loading"),form.html(""),$.post(n.url,a,o.bind(n),"json").fail(i.bind(n)),!1}var a=(!!(window.File&&window.FileReader&&window.FileList&&window.Blob),{error_class:".has-error"});t.find("[required]").addClass("required").removeAttr("required");for(var e=0;e<t.length;e++)wrap=t.eq(e),form=wrap.find("form"),data={form:form,param:a,wrap:wrap},data.url=form.attr("action")||location.href,data.method=form.attr("method")||"post",form.off("submit"),form.on("submit",n.bind(data))}function addSRO(){$.fn.serializeObject=function(){var t={},o=this.serializeArray();return $.each(o,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}}function checkDisabled(t,o,i){var n=$(t).find('input[type="text"].'+i);n.val(""),n.attr("disabled",o)}var accordionControl=$(".accordion .accordion-control");accordionControl.on("click",function(t){return t.preventDefault(),$this=$(this),$accordion=$this.closest(".accordion"),$accordion.hasClass("open")?($accordion.find(".accordion-content").hide(300),$accordion.removeClass("open")):($accordion.find(".accordion-content").show(300),$accordion.addClass("open")),!1}),accordionControl.show(),objects=function(t,o){var i,n=o;for(i in t)t.hasOwnProperty(i)&&(n[i]=i in o?o[i]:t[i]);return n},$(document).ready(function(){function t(){data=this,0==data.type?data.img.attr("src",data.src):(data.img.css("background-image","url("+data.src+")"),data.img.removeClass("no_ava"))}imgs=$("section:not(.navigation)").find(".logo img");for(var o=0;o<imgs.length;o++)img=imgs.eq(o),src=img.attr("src"),img.attr("src","/images/template-logo.jpg"),data={src:src,img:img,type:0},image=$("<img/>",{src:src}).on("load",t.bind(data));imgs=$(".comment-photo");for(var o=0;o<imgs.length;o++)img=imgs.eq(o),img.hasClass("no_ava")||(src=img.css("background-image"),src=src.replace('url("',""),src=src.replace('")',""),img.addClass("no_ava"),img.css("background-image","url(/images/no_ava.png)"),data={src:src,img:img,type:1},image=$("<img/>",{src:src}).on("load",t.bind(data)))}),function(){for(els=$(".ajax_load"),i=0;i<els.length;i++)el=els.eq(i),url=el.attr("res"),$.get(url,function(t){$this=$(this),$this.html(t),ajaxForm($this)}.bind(el))}(),$("input[type=file]").on("change",function(t){var o=t.target.files,i=o[0];if(!i.type.match("image.*"))return!1;var n=new FileReader;data={el:this,f:i},n.onload=function(t){return function(o){img=$('[for="'+t.el.name+'"]'),img.length>0&&img.attr("src",o.target.result)}}(data),n.readAsDataURL(i)}),$("body").on("click","a.ajaxFormOpen",function(t){t.preventDefault(),href=this.href.split("#"),href=href[href.length-1],data={buttonYes:!1,notyfy_class:"notify_white loading",question:""},modal_class=$(this).data("modal-class"),notification.alert(data),$.get("/"+href,function(t){$(".notify_box").removeClass("loading"),$(".notify_box .notify_content").html(t.html),ajaxForm($(".notify_box .notify_content")),modal_class&&$(".notify_box .notify_content .row").addClass(modal_class)},"json")}),setTimeout(function(){CookieChecker.run()},2e3);var notification=function(){function t(){f=!0,m=$(".notification_box"),m.length>0||($("body").append("<div class='notification_box'></div>"),m=$(".notification_box"),m.on("click",".notify_control",o),m.on("click",".notify_close",o),m.on("click",i))}function o(){$("html").removeClass("show_notifi")}function i(t){var i=t.target||t.srcElement;"notification_box"==i.className&&o()}function n(o){o||(o={}),o=objects(u,o),f||t(),notyfy_class="notify_box ",o.notyfy_class&&(notyfy_class+=o.notyfy_class),box_html='<div class="'+notyfy_class+'">',box_html+='<div class="notify_title">',box_html+=o.title,box_html+='<span class="notify_close"></span>',box_html+="</div>",box_html+='<div class="notify_content">',box_html+=o.question,box_html+="</div>",(o.buttonYes||o.buttonNo)&&(box_html+='<div class="notify_control">',o.buttonYes&&(box_html+="<"+o.buttonTag+' class="notify_btn_yes" '+o.buttonYesDop+">"+o.buttonYes+"</"+o.buttonTag+">"),o.buttonNo&&(box_html+="<"+o.buttonTag+' class="notify_btn_no" '+o.buttonNoDop+">"+o.buttonNo+"</"+o.buttonTag+">"),box_html+="</div>"),box_html+="</div>",m.html(box_html),setTimeout(function(){$("html").addClass("show_notifi")},100)}function a(o){o||(o={}),o=objects(h,o),f||t(),box_html='<div class="notify_box">',box_html+='<div class="notify_title">',box_html+=o.title,box_html+='<span class="notify_close"></span>',box_html+="</div>",box_html+='<div class="notify_content">',box_html+=o.question,box_html+="</div>",(o.buttonYes||o.buttonNo)&&(box_html+='<div class="notify_control">',o.buttonYes&&(box_html+='<div class="notify_btn_yes">'+o.buttonYes+"</div>"),o.buttonNo&&(box_html+='<div class="notify_btn_no">'+o.buttonNo+"</div>"),box_html+="</div>"),box_html+="</div>",m.html(box_html),0!=o.callbackYes&&m.find(".notify_btn_yes").on("click",o.callbackYes.bind(o.obj)),0!=o.callbackNo&&m.find(".notify_btn_no").on("click",o.callbackNo.bind(o.obj)),setTimeout(function(){$("html").addClass("show_notifi")},100)}function e(t){t||(t={});var o={time:t.time||0===t.time?t.time:d};s||(s=$("<ul/>",{"class":"notification_container"}),$("body").append(s),b());var i=$("<li/>",{"class":"notification_item"});t.type&&i.addClass("notification_item-"+t.type);var n=$("<span/>",{"class":"notification_close"});if(o.close=n,i.append(n),t.title&&t.title.length>0){var a=$("<p/>",{"class":"notification_title"});a.html(t.title),i.append(a)}if(t.img&&t.img.length>0){var e=$("<div/>",{"class":"notification_img"});e.css("background-image","url("+t.img+")"),i.append(e)}var r=$("<div/>",{"class":"notification_content"});r.html(t.message),i.append(r),s.append(i),o.time>0&&(o.timer=setTimeout(v.bind(n),o.time)),i.data("option",o)}var s,r=0,c=null,l="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",d=1e4,m=!1,f=!1,h={title:"Удаление",question:"Вы действительно хотите удалить?",buttonYes:"Да",buttonNo:"Нет",callbackYes:!1,callbackNo:!1,obj:!1,buttonTag:"div",buttonYesDop:"",buttonNoDop:""},u={title:"",question:"Сообщение",buttonYes:"Да",callbackYes:!1,obj:!1},b=function(){$("body").on("click",".notification_close",v),$("body").on("mouseenter",".notification_container",_),$("body").on("mouseleave",".notification_container",p)},_=function(t){t&&t.preventDefault(),null!=c&&(clearTimeout(c),c=null),s.find(".notification_item").each(function(t){var o=$(this).data("option");o.timer&&clearTimeout(o.timer)}),r=1},p=function(){s.find(".notification_item").each(function(t){$this=$(this);var o=$this.data("option");o.time>0&&(o.timer=setTimeout(v.bind(o.close),o.time-1500+100*t),$this.data("option",o))}),r=0},v=function(t){t&&t.preventDefault();var o=$(this).parent();o.on(l,function(){$(this).remove()}),o.addClass("notification_hide")};return{alert:n,confirm:a,notifi:e}}();$("[ref=popup]").on("click",function(t){t.preventDefault(),$this=$(this),el=$($this.attr("href")),data=el.data(),data.question=el.html(),notification.alert(data)}),addSRO(),$(".action_user_confirm").click(function(){if(!confirm())return!1});var storesPointCheckboxes=$('.b2b-stores-points-form input[type="checkbox"]');storesPointCheckboxes.click(function(){var t=$(this).attr("name"),o=$(this).closest("tr");t.match(/B2bStoresPoints\[work_time_details\]\[\d*\]\[24-hour\]/)&&checkDisabled(o,this.checked,"depends-24-hour")}),$.each(storesPointCheckboxes,function(t,o){var i=$(o).attr("name"),n=$(o).closest("tr");i.match(/B2bStoresPoints\[work_time_details\]\[\d*\]\[24-hour\]/)&&o.checked&&checkDisabled(n,!0,"depends-24-hour")});