function login_redirect(t){href=location.href,href.indexOf("store")>0||href.indexOf("coupon")>0?location.reload():location.href=t}function ajaxForm(t){function o(t){var o=this;form=o.form,wrap=o.wrap,t.render?(t.notyfy_class="notify_white",notification.alert(t)):(wrap.removeClass("loading"),wrap.html(t.html),ajaxForm(wrap))}function e(){var t=this;form=t.form,wrap=t.wrap,wrap.removeClass("loading"),wrap.html("<h3>Упс... Возникла непредвиденная ошибка<h3><p>Часто это происходит в случае, если вы несколько раз подряд неверно ввели свои учетные данные. Но возможны и другие причины. В любом случае не расстраивайтесь и просто обратитесь к нашему оператору службы поддержки.</p><br><p>Спасибо.</p>"),ajaxForm(wrap)}function n(t){t.preventDefault();var n=this;if(form=n.form,wrap=n.wrap,form.yiiActiveForm&&form.yiiActiveForm("validate"),isValid=0==form.find(n.param.error_class).length,!isValid)return!1;for(required=form.find("input.required"),a=0;a<required.length;a++)if(required.eq(a).val().length<1)return!1;form.serializeObject||addSRO();var i=form.serializeObject();return form.addClass("loading"),form.html(""),wrap.html('<div style="text-align:center;"><p>Отправка данных</p></div>'),n.url+=(n.url.indexOf("?")>0?"&":"?")+"rc="+Math.random(),$.post(n.url,i,o.bind(n),"json").fail(e.bind(n)),!1}var i=(!!(window.File&&window.FileReader&&window.FileList&&window.Blob),{error_class:".has-error"});t.find("[required]").addClass("required").removeAttr("required");for(var a=0;a<t.length;a++)wrap=t.eq(a),form=wrap.find("form"),data={form:form,param:i,wrap:wrap},data.url=form.attr("action")||location.href,data.method=form.attr("method")||"post",form.off("submit"),form.on("submit",n.bind(data))}function addSRO(){$.fn.serializeObject=function(){var t={},o=this.serializeArray();return $.each(o,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}}objects=function(t,o){var e,n=o;for(e in t)t.hasOwnProperty(e)&&(n[e]=e in o?o[e]:t[e]);return n},function(t,o,e){function n(){var t='<div class="scroll_box-control"></div>';t=e(t),t.insertAfter(c),t.data("slide-active",0),c.prepend("<div class=scroll_box-mover></div>"),t.on("click",".scroll_box-control_point",function(){var t=e(this),o=t.parent(),n=t.index();if(!t.hasClass("active")){o.find(".active").removeClass("active"),t.addClass("active");var i=o.data("slide-dx"),a=o.prev();a.find(".scroll_box-mover").css("margin-left",-i*n),o.data("slide-active",n),s.bind(a)()}})}function a(){var t=e(this);if(t.hasClass("scroll_box-active")){var o=setTimeout(l.bind(t),2e3);t.data("slide-timeoutId",o)}}function s(){var t=e(this),o=t.data("slide-timeoutId");t.data("slide-timeoutId",!1),t.hasClass("scroll_box-active")&&o&&clearTimeout(o)}function l(){var t=e(this);if(t.data("slide-timeoutId",!1),t.hasClass("scroll_box-active")){var o=t.next().find(">*"),n=t.data("slide-active"),i=o.length;n||(n=0),n++,n>=i&&(n=0),t.data("slide-active",n),o.eq(n).click(),a.bind(t)()}}function r(){for(i=0;i<c.length;i++){var o=c.eq(i),e=o.next(),n=o.data("scroll-width-max");if(t=o.width(),n&&t>n)e.removeClass("scroll_box-active"),e.data("slide-active",0);else{var s=o.data("scroll-elemet-ignore-class"),l=o.find(">*").not(".scroll_box-mover");if(s&&(l=l.not("."+s)),0!=l){var r=l.eq(1),d=r.outerWidth();d+=parseFloat(r.css("margin-left")),d+=parseFloat(r.css("margin-right"));var f=Math.floor(t/d);if(l<=f)o.removeClass("scroll_box-active"),e.data("slide-active",0);else{o.addClass("scroll_box-active");var m=l.length-f+1;if(e.find(">*").length!=m){active=o.data("slide-active"),active||(active=0),active>=m&&(active=m-1);for(var u="",h=0;h<m;h++)u+='<div class="scroll_box-control_point'+(h==active?" active":"")+'"></div>';e.html(u),e.data("slide-active",active),e.data("slide-count",m),e.data("slide-dx",d),o.data("slide-timeoutId")||a.bind(o)()}else e.data("slide-dx",d)}}else o.removeClass("scroll_box-active"),e.data("slide-active",0)}}}var c=e(".scroll_box");if(0!=c.length){e(c).wrap('<div class="scroll_box-wrap"></div>'),n(),r();var d,f;e(window).resize(function(){clearTimeout(d),clearTimeout(f),d=setTimeout(r,300),f=setTimeout(r,800)});for(var m=0;m<c.length;m++){var u=c.eq(m);u.parent().hover(s.bind(u),a.bind(u))}}}(window,document,jQuery);var accordionControl=$(".accordion .accordion-control");accordionControl.on("click",function(t){return t.preventDefault(),$this=$(this),$accordion=$this.closest(".accordion"),$accordion.hasClass("open")?($accordion.find(".accordion-content").hide(300),$accordion.removeClass("open")):($accordion.hasClass("accordion-slim")&&($other=$accordion.parent().find(".accordion-slim"),$other.find(".accordion-content").hide(300).removeClass("accordion-content_last-open"),$other.removeClass("open"),$other.removeClass("last-open"),$accordion.find(".accordion-content").addClass("accordion-content_last-open"),$accordion.addClass("last-open")),$accordion.find(".accordion-content").show(300),$accordion.addClass("open")),!1}),accordionControl.show(),accordionSlim=$(".accordion.accordion-slim"),accordionSlim.length>0&&accordionSlim.parent().find(".accordion-slim:first-child").addClass("open").addClass("last-open").find(".accordion-content").show(300).addClass("accordion-content_last-open"),addSRO();var notification=function(){function t(){m=!0,f=$(".notification_box"),f.length>0||($("body").append("<div class='notification_box'></div>"),f=$(".notification_box"),f.on("click",".notify_control",o),f.on("click",".notify_close",o),f.on("click",e))}function o(){$("html").removeClass("show_notifi"),$(".notification_box .notify_content").html("")}function e(t){var e=t.target||t.srcElement;"notification_box"==e.className&&o()}function n(o){o||(o={}),o=objects(h,o),m||t(),notyfy_class="notify_box ",o.notyfy_class&&(notyfy_class+=o.notyfy_class),box_html='<div class="'+notyfy_class+'">',box_html+='<div class="notify_title">',box_html+=o.title,box_html+='<span class="notify_close"></span>',box_html+="</div>",box_html+='<div class="notify_content">',box_html+=o.question,box_html+="</div>",(o.buttonYes||o.buttonNo)&&(box_html+='<div class="notify_control">',o.buttonYes&&(box_html+="<"+o.buttonTag+' class="notify_btn_yes" '+o.buttonYesDop+">"+o.buttonYes+"</"+o.buttonTag+">"),o.buttonNo&&(box_html+="<"+o.buttonTag+' class="notify_btn_no" '+o.buttonNoDop+">"+o.buttonNo+"</"+o.buttonTag+">"),box_html+="</div>"),box_html+="</div>",f.html(box_html),setTimeout(function(){$("html").addClass("show_notifi")},100)}function i(o){o||(o={}),o=objects(u,o),m||t(),box_html='<div class="notify_box">',box_html+='<div class="notify_title">',box_html+=o.title,box_html+='<span class="notify_close"></span>',box_html+="</div>",box_html+='<div class="notify_content">',box_html+=o.question,box_html+="</div>",(o.buttonYes||o.buttonNo)&&(box_html+='<div class="notify_control">',o.buttonYes&&(box_html+='<div class="notify_btn_yes">'+o.buttonYes+"</div>"),o.buttonNo&&(box_html+='<div class="notify_btn_no">'+o.buttonNo+"</div>"),box_html+="</div>"),box_html+="</div>",f.html(box_html),0!=o.callbackYes&&f.find(".notify_btn_yes").on("click",o.callbackYes.bind(o.obj)),0!=o.callbackNo&&f.find(".notify_btn_no").on("click",o.callbackNo.bind(o.obj)),setTimeout(function(){$("html").addClass("show_notifi")},100)}function a(t){t||(t={});var o={time:t.time||0===t.time?t.time:d};s||(s=$("<ul/>",{"class":"notification_container"}),$("body").append(s),v());var e=$("<li/>",{"class":"notification_item"});t.type&&e.addClass("notification_item-"+t.type);var n=$("<span/>",{"class":"notification_close"});o.close=n,e.append(n);var i=$("<div/>",{"class":"notification_content"});if(t.title&&t.title.length>0){var a=$("<h5/>",{"class":"notification_title"});a.html(t.title),i.append(a)}var l=$("<div/>",{"class":"notification_text"});if(l.html(t.message),t.img&&t.img.length>0){var r=$("<div/>",{"class":"notification_img"});r.css("background-image","url("+t.img+")");var c=$("<div/>",{"class":"wrap"});c.append(r),c.append(l),i.append(c)}else i.append(l);e.append(i),s.append(e),o.time>0&&(o.timer=setTimeout(_.bind(n),o.time)),e.data("option",o)}var s,l=0,r=null,c="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",d=1e4,f=!1,m=!1,u={title:"Удаление",question:"Вы действительно хотите удалить?",buttonYes:"Да",buttonNo:"Нет",callbackYes:!1,callbackNo:!1,obj:!1,buttonTag:"div",buttonYesDop:"",buttonNoDop:""},h={title:"",question:"Сообщение",buttonYes:"Да",callbackYes:!1,buttonTag:"div",obj:!1},v=function(){$("body").on("click",".notification_close",_),$("body").on("mouseenter",".notification_container",p),$("body").on("mouseleave",".notification_container",b)},p=function(t){t&&t.preventDefault(),null!=r&&(clearTimeout(r),r=null),s.find(".notification_item").each(function(t){var o=$(this).data("option");o.timer&&clearTimeout(o.timer)}),l=1},b=function(){s.find(".notification_item").each(function(t){$this=$(this);var o=$this.data("option");o.time>0&&(o.timer=setTimeout(_.bind(o.close),o.time-1500+100*t),$this.data("option",o))}),l=0},_=function(t){t&&t.preventDefault();var o=$(this).parent();o.on(c,function(){$(this).remove()}),o.addClass("notification_hide")};return{alert:n,confirm:i,notifi:a}}();$("[ref=popup]").on("click",function(t){t.preventDefault(),$this=$(this),el=$($this.attr("href")),data=el.data(),data.question=el.html(),notification.alert(data)}),function(){$("body").on("click",".modals_open",function(t){t.preventDefault();var o=$("a[href='#showpromocode-noregister']").data("popup");return o?o.close():(o=$("div.popup_cont, div.popup_back"),o&&o.hide()),href=this.href.split("#"),href=href[href.length-1],data={buttonYes:!1,notyfy_class:"loading "+(0===href.indexOf("video")?"modals-full_screen":"notify_white"),question:""},notification.alert(data),$.get("/"+href,function(t){$(".notify_box").removeClass("loading"),$(".notify_box .notify_content").html(t.html),ajaxForm($(".notify_box .notify_content"))},"json"),console.log(this),!1})}(),$(".footer-menu-title").on("click",function(t){$this=$(this),$this.hasClass("footer-menu-title_open")?$this.removeClass("footer-menu-title_open"):($(".footer-menu-title_open").removeClass("footer-menu-title_open"),$this.addClass("footer-menu-title_open"))}),$(function(){function t(t){var o=$(".rating-wrapper .rating-star");o.addClass("rating-star-open");for(var e=0;e<t;e++)o.eq(e).removeClass("rating-star-open")}$(document).on("mouseover",".rating-wrapper .rating-star",function(o){t($(this).index()+1)}).on("mouseleave",".rating-wrapper",function(o){t($('.notify_content input[name="Reviews[rating]"]').val())}).on("click",".rating-wrapper .rating-star",function(o){t($(this).index()+1),$('.notify_content input[name="Reviews[rating]"]').val($(this).index()+1)})});var headerActions=function(){var t=!1,o=!1;$(".menu-toggle").click(function(t){t.preventDefault(),$(".header").toggleClass("header_open-menu")}),$("#header").click(function(t){"header"==t.target.id&&$(this).removeClass("header_open-menu")}),$(".search-toggle").click(function(t){t.preventDefault(),$(".header-search").toggleClass("open")}),$(".header-secondline_close").click(function(t){$(".header").removeClass("header_open-menu")}),$(window).on("load resize scroll",function(){var e=50,n=200,i=$(".header-secondline"),a=i.find(":hover"),s=$(".header");if(a.length)i.addClass("scrollable"),s.addClass("scrollable");else{i.removeClass("scrollable"),s.removeClass("scrollable");var l=$(window).scrollTop();l>e&&o===!1&&(o=!0,i.addClass("shadowed")),l<=e&&o===!0&&(o=!1,i.removeClass("shadowed")),l>n&&t===!1&&(t=!0,i.addClass("scroll-down")),l<=n&&t===!0&&(t=!1,i.removeClass("scroll-down"))}}),$(".menu_angle-down").click(function(t){t.preventDefault();var o=$(this).closest(".drop-menu_group__up, .menu-group");return o&&($(o).siblings("li").removeClass("open"),$(o).toggleClass("open")),!1});var e=null;$(".account-menu-toggle").click(function(t){t.preventDefault();var o=$(".account-menu");o&&(clearTimeout(e),o.toggleClass("hidden"),o.hasClass("hidden")||(e=setTimeout(function(){o.addClass("hidden")},7e3)))}),$(".header-search_form-input").on("input",function(t){t.preventDefault();var o=$(this).val(),e=$("#autocomplete"),n=$(e).find("ul");return o.length>1?$.ajax({url:"/search",type:"get",data:{query:o},dataType:"json",success:function(t){t.suggestions&&(e&&$(n).html(""),t.suggestions.length?(t.suggestions.forEach(function(t){var o='<a href="/stores/'+t.data.route+'">'+t.value+t.cashback+"</a>",e=document.createElement("li");e.innerHTML=o,n&&$(n).append(e)}),e&&$(e).fadeIn()):e&&$(e).fadeOut())}}):e&&($(n).html(""),$(e).fadeOut()),!1})}();