function login_redirect(o){href=location.href,href.indexOf("store")>0||href.indexOf("coupon")>0?location.reload():location.href=o}function ajaxForm(o){function t(o){var t=this;form=t.form,wrap=t.wrap,o.render?(o.notyfy_class="notify_white",notification.alert(o)):(wrap.removeClass("loading"),wrap.html(o.html),ajaxForm(wrap))}function e(){var o=this;form=o.form,wrap=o.wrap,wrap.removeClass("loading"),wrap.html("<h3>Упс... Возникла непредвиденная ошибка<h3><p>Часто это происходит в случае, если вы несколько раз подряд неверно ввели свои учетные данные. Но возможны и другие причины. В любом случае не расстраивайтесь и просто обратитесь к нашему оператору службы поддержки.</p><br><p>Спасибо.</p>"),ajaxForm(wrap)}function i(o){o.preventDefault();var i=this;if(form=i.form,wrap=i.wrap,form.yiiActiveForm&&form.yiiActiveForm("validate"),isValid=0==form.find(i.param.error_class).length,!isValid)return!1;for(required=form.find("input.required"),a=0;a<required.length;a++)if(required.eq(a).val().length<1)return!1;form.serializeObject||addSRO();var n=form.serializeObject();return form.addClass("loading"),form.html(""),wrap.html('<div style="text-align:center;"><p>Отправка данных</p></div>'),i.url+=(i.url.indexOf("?")>0?"&":"?")+"rc="+Math.random(),$.post(i.url,n,t.bind(i),"json").fail(e.bind(i)),!1}var n=(!!(window.File&&window.FileReader&&window.FileList&&window.Blob),{error_class:".has-error"});o.find("[required]").addClass("required").removeAttr("required");for(var a=0;a<o.length;a++)wrap=o.eq(a),form=wrap.find("form"),data={form:form,param:n,wrap:wrap},data.url=form.attr("action")||location.href,data.method=form.attr("method")||"post",form.off("submit"),form.on("submit",i.bind(data))}function addSRO(){$.fn.serializeObject=function(){var o={},t=this.serializeArray();return $.each(t,function(){o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o}}objects=function(o,t){var e,i=t;for(e in o)o.hasOwnProperty(e)&&(i[e]=e in t?t[e]:o[e]);return i},function(o,t,e){function n(){var o='<div class="scroll_box-control"></div>';o=e(o),o.insertAfter(c),o.data("slide-active",0),c.prepend("<div class=scroll_box-mover></div>"),o.on("click",".scroll_box-control_point",function(){var o=e(this),t=o.parent(),i=o.index();if(!o.hasClass("active")){t.find(".active").removeClass("active"),o.addClass("active");var n=t.data("slide-dx"),a=t.prev();a.find(".scroll_box-mover").css("margin-left",-n*i),t.data("slide-active",i),s.bind(a)()}})}function a(){var o=e(this);if(o.hasClass("scroll_box-active")){var t=setTimeout(l.bind(o),2e3);o.data("slide-timeoutId",t)}}function s(){var o=e(this),t=o.data("slide-timeoutId");o.data("slide-timeoutId",!1),o.hasClass("scroll_box-active")&&t&&clearTimeout(t)}function l(){var o=e(this);if(o.data("slide-timeoutId",!1),o.hasClass("scroll_box-active")){var t=o.next().find(">*"),i=o.data("slide-active"),n=t.length;i||(i=0),i++,i>=n&&(i=0),o.data("slide-active",i),t.eq(i).click(),a.bind(o)()}}function r(){for(i=0;i<c.length;i++){var t=c.eq(i),e=t.next(),n=t.data("scroll-width-max");if(o=t.width(),n&&o>n)e.removeClass("scroll_box-active"),e.data("slide-active",0);else{var s=t.data("scroll-elemet-ignore-class"),l=t.find(">*").not(".scroll_box-mover");if(s&&(l=l.not("."+s)),0!=l){var r=l.eq(1),d=r.outerWidth();d+=parseFloat(r.css("margin-left")),d+=parseFloat(r.css("margin-right"));var f=Math.floor(o/d);if(l<=f)t.removeClass("scroll_box-active"),e.data("slide-active",0);else{t.addClass("scroll_box-active");var m=l.length-f+1;if(e.find(">*").length!=m){active=t.data("slide-active"),active||(active=0),active>=m&&(active=m-1);for(var u="",h=0;h<m;h++)u+='<div class="scroll_box-control_point'+(h==active?" active":"")+'"></div>';e.html(u),e.data("slide-active",active),e.data("slide-count",m),e.data("slide-dx",d),t.data("slide-timeoutId")||a.bind(t)()}else e.data("slide-dx",d)}}else t.removeClass("scroll_box-active"),e.data("slide-active",0)}}}var c=e(".scroll_box");if(0!=c.length){e(c).wrap('<div class="scroll_box-wrap"></div>'),n(),r();var d,f;e(window).resize(function(){clearTimeout(d),clearTimeout(f),d=setTimeout(r,300),f=setTimeout(r,800)});for(var m=0;m<c.length;m++){var u=c.eq(m);u.parent().hover(s.bind(u),a.bind(u))}}}(window,document,jQuery);var accordionControl=$(".accordion .accordion-control");accordionControl.on("click",function(o){return o.preventDefault(),$this=$(this),$accordion=$this.closest(".accordion"),$accordion.hasClass("open")?($accordion.find(".accordion-content").hide(300),$accordion.removeClass("open")):($accordion.hasClass("accordion-slim")&&($other=$accordion.parent().find(".accordion-slim"),$other.find(".accordion-content").hide(300).removeClass("accordion-content_last-open"),$other.removeClass("open"),$other.removeClass("last-open"),$accordion.find(".accordion-content").addClass("accordion-content_last-open"),$accordion.addClass("last-open")),$accordion.find(".accordion-content").show(300),$accordion.addClass("open")),!1}),accordionControl.show(),accordionSlim=$(".accordion.accordion-slim"),accordionSlim.length>0&&accordionSlim.parent().find(".accordion-slim:first-child").addClass("open").addClass("last-open").find(".accordion-content").show(300).addClass("accordion-content_last-open"),addSRO();var notification=function(){function o(){m=!0,f=$(".notification_box"),f.length>0||($("body").append("<div class='notification_box'></div>"),f=$(".notification_box"),f.on("click",".notify_control",t),f.on("click",".notify_close",t),f.on("click",e))}function t(){$("html").removeClass("show_notifi"),$(".notification_box .notify_content").html("")}function e(o){var e=o.target||o.srcElement;"notification_box"==e.className&&t()}function i(t){t||(t={}),t=objects(h,t),m||o(),notyfy_class="notify_box ",t.notyfy_class&&(notyfy_class+=t.notyfy_class),box_html='<div class="'+notyfy_class+'">',box_html+='<div class="notify_title">',box_html+=t.title,box_html+='<span class="notify_close"></span>',box_html+="</div>",box_html+='<div class="notify_content">',box_html+=t.question,box_html+="</div>",(t.buttonYes||t.buttonNo)&&(box_html+='<div class="notify_control">',t.buttonYes&&(box_html+="<"+t.buttonTag+' class="notify_btn_yes" '+t.buttonYesDop+">"+t.buttonYes+"</"+t.buttonTag+">"),t.buttonNo&&(box_html+="<"+t.buttonTag+' class="notify_btn_no" '+t.buttonNoDop+">"+t.buttonNo+"</"+t.buttonTag+">"),box_html+="</div>"),box_html+="</div>",f.html(box_html),setTimeout(function(){$("html").addClass("show_notifi")},100)}function n(t){t||(t={}),t=objects(u,t),m||o(),box_html='<div class="notify_box">',box_html+='<div class="notify_title">',box_html+=t.title,box_html+='<span class="notify_close"></span>',box_html+="</div>",box_html+='<div class="notify_content">',box_html+=t.question,box_html+="</div>",(t.buttonYes||t.buttonNo)&&(box_html+='<div class="notify_control">',t.buttonYes&&(box_html+='<div class="notify_btn_yes">'+t.buttonYes+"</div>"),t.buttonNo&&(box_html+='<div class="notify_btn_no">'+t.buttonNo+"</div>"),box_html+="</div>"),box_html+="</div>",f.html(box_html),0!=t.callbackYes&&f.find(".notify_btn_yes").on("click",t.callbackYes.bind(t.obj)),0!=t.callbackNo&&f.find(".notify_btn_no").on("click",t.callbackNo.bind(t.obj)),setTimeout(function(){$("html").addClass("show_notifi")},100)}function a(o){o||(o={});var t={time:o.time||0===o.time?o.time:d};s||(s=$("<ul/>",{"class":"notification_container"}),$("body").append(s),v());var e=$("<li/>",{"class":"notification_item"});o.type&&e.addClass("notification_item-"+o.type);var i=$("<span/>",{"class":"notification_close"});t.close=i,e.append(i);var n=$("<div/>",{"class":"notification_content"});if(o.title&&o.title.length>0){var a=$("<h5/>",{"class":"notification_title"});a.html(o.title),n.append(a)}var l=$("<div/>",{"class":"notification_text"});if(l.html(o.message),o.img&&o.img.length>0){var r=$("<div/>",{"class":"notification_img"});r.css("background-image","url("+o.img+")");var c=$("<div/>",{"class":"wrap"});c.append(r),c.append(l),n.append(c)}else n.append(l);e.append(n),s.append(e),t.time>0&&(t.timer=setTimeout(_.bind(i),t.time)),e.data("option",t)}var s,l=0,r=null,c="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",d=1e4,f=!1,m=!1,u={title:"Удаление",question:"Вы действительно хотите удалить?",buttonYes:"Да",buttonNo:"Нет",callbackYes:!1,callbackNo:!1,obj:!1,buttonTag:"div",buttonYesDop:"",buttonNoDop:""},h={title:"",question:"Сообщение",buttonYes:"Да",callbackYes:!1,buttonTag:"div",obj:!1},v=function(){$("body").on("click",".notification_close",_),$("body").on("mouseenter",".notification_container",p),$("body").on("mouseleave",".notification_container",b)},p=function(o){o&&o.preventDefault(),null!=r&&(clearTimeout(r),r=null),s.find(".notification_item").each(function(o){var t=$(this).data("option");t.timer&&clearTimeout(t.timer)}),l=1},b=function(){s.find(".notification_item").each(function(o){$this=$(this);var t=$this.data("option");t.time>0&&(t.timer=setTimeout(_.bind(t.close),t.time-1500+100*o),$this.data("option",t))}),l=0},_=function(o){o&&o.preventDefault();var t=$(this).parent();t.on(c,function(){$(this).remove()}),t.addClass("notification_hide")};return{alert:i,confirm:n,notifi:a}}();$("[ref=popup]").on("click",function(o){o.preventDefault(),$this=$(this),el=$($this.attr("href")),data=el.data(),data.question=el.html(),notification.alert(data)}),function(){$("body").on("click",".modals_open",function(o){o.preventDefault();var t=$("a[href='#showpromocode-noregister']").data("popup");return t?t.close():(t=$("div.popup_cont, div.popup_back"),t&&t.hide()),href=this.href.split("#"),href=href[href.length-1],data={buttonYes:!1,notyfy_class:"loading "+(0===href.indexOf("video")?"modals-full_screen":"notify_white"),question:""},notification.alert(data),$.get("/"+href,function(o){$(".notify_box").removeClass("loading"),$(".notify_box .notify_content").html(o.html),ajaxForm($(".notify_box .notify_content"))},"json"),console.log(this),!1})}(),$(".footer-menu-title").on("click",function(o){$this=$(this),$this.hasClass("footer-menu-title_open")?$this.removeClass("footer-menu-title_open"):($(".footer-menu-title_open").removeClass("footer-menu-title_open"),$this.addClass("footer-menu-title_open"))}),$(function(){function o(o){var t=$(".rating-wrapper .rating-star");t.addClass("rating-star-open");for(var e=0;e<o;e++)t.eq(e).removeClass("rating-star-open")}$(document).on("mouseover",".rating-wrapper .rating-star",function(t){o($(this).index()+1)}).on("mouseleave",".rating-wrapper",function(t){o($('.notify_content input[name="Reviews[rating]"]').val())}).on("click",".rating-wrapper .rating-star",function(t){o($(this).index()+1),$('.notify_content input[name="Reviews[rating]"]').val($(this).index()+1)})});var headerActions=function(){var o=!1,t=!1;$(".menu-toggle").click(function(o){o.preventDefault(),$(".header").toggleClass("header_open-menu"),$(".drop-menu").find("li").removeClass("open").removeClass("close")}),$("#header").click(function(o){"header"==o.target.id&&$(this).removeClass("header_open-menu")}),$(".search-toggle").click(function(o){o.preventDefault(),$(".header-search").toggleClass("open"),$("#autocomplete").fadeOut()}),$(".header-secondline_close").click(function(o){$(".header").removeClass("header_open-menu")}),$(".header-upline").on("mouseover",function(t){$(".header-secondline").removeClass("scroll-down"),o=!1}),$(window).on("load resize scroll",function(){var e=50,i=200,n=$(".header-secondline"),a=n.find(":hover"),s=$(".header");if(a.length)n.addClass("scrollable"),s.addClass("scrollable");else{n.removeClass("scrollable"),s.removeClass("scrollable");var l=$(window).scrollTop();l>e&&t===!1&&(t=!0,n.addClass("shadowed")),l<=e&&t===!0&&(t=!1,n.removeClass("shadowed")),l>i&&o===!1&&(o=!0,n.addClass("scroll-down")),l<=i&&o===!0&&(o=!1,n.removeClass("scroll-down"))}}),$(".menu_angle-down").click(function(o){o.preventDefault();var t=$(this).closest(".drop-menu_group__up, .menu-group"),e=$(this).closest(".drop-menu");return e&&$(e).siblings("ul").find("li").removeClass("open"),t&&($(t).siblings("li").removeClass("open"),$(t).toggleClass("open"),t.hasClass("open")?($(t).removeClass("close"),$(t).siblings("li").addClass("close"),e&&$(e).siblings("ul").children("li").addClass("close")):($(t).siblings("li").removeClass("close"),e&&$(e).siblings("ul").children("li").removeClass("close"))),!1});var e=null;$(".account-menu-toggle").click(function(o){o.preventDefault();var t=$(".account-menu");t&&(clearTimeout(e),t.toggleClass("hidden"),t.hasClass("hidden")||(e=setTimeout(function(){t.addClass("hidden")},7e3)))}),$(".header-search_form-input").on("input",function(o){o.preventDefault();var t=$(this).val(),e=$("#autocomplete"),i=$(e).find("ul");return t.length>1?$.ajax({url:"/search",type:"get",data:{query:t},dataType:"json",success:function(o){o.suggestions&&(e&&$(i).html(""),o.suggestions.length?(o.suggestions.forEach(function(o){var t='<a href="/stores/'+o.data.route+'">'+o.value+o.cashback+"</a>",e=document.createElement("li");e.innerHTML=t,i&&$(i).append(e)}),e&&$(e).fadeIn()):e&&$(e).fadeOut())}}):e&&($(i).html(""),$(e).fadeOut()),!1})}();