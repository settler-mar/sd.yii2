tinymce.PluginManager.add('blocks', function(editor, url) {
    // Add a button that opens a window
    editor.addButton('blocks', {
        type: 'menubutton',
        text: 'Blocks',
        icon: false,
        //onclick: accordionAdd,
        stateSelector: 'div',
        menu: [
            {
                text: 'Серый со скруглёнными краями',
                onclick: accordionAdd.bind('gray-box wrap-round')
            },

        ]
    });


    function accordionAdd() {
        // Top most window object
        win = editor.windowManager.getWindows()[0];
        current = $(editor.selection.getNode()).closest('.accordion');
        var className = this;
        var blk='';
        var selectedText = '';

        if (current.length > 0) {
            return;
        }
        selectedText = editor.selection.getContent();

        if(selectedText.length<1){
          selectedText='Блок серый со скруглёнными краями'
        }
        blk += '<div class="'+className+'">' +
                    selectedText+
              '</div><br>';
        editor.insertContent(blk);
    }
});
