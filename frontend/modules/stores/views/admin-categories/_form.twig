{{ use('/yii/widgets/ActiveForm') }}

<div class="stores-index">
    <div class="content-wrapper">
        <section>
            <div class="row">
                <div class="col-md-12">
                    <h1>{{ html.encode(this.title) }}</h1>
                </div>
                {% set form = active_form_begin() %}
                <div class="col-md-6">
                    {{ form.field(model, 'parent_id').dropDownList(parentsList)|raw }}

                    {{ form.field(model, 'route').textInput({'maxlength':true})|raw }}

                    {{ form.field(model, 'map_icon').widget(iconSelectClass,iconSelectParam)|raw }}

                    {{ form.field(model, 'is_active').dropDownList({
                        0:"Скрытая",
                        1:"Активная",
                    })|raw }}
                </div>
                <div class="col-md-6">
                    {{ form.field(model, 'menu_index').textInput()|raw }}

                    {{ form.field(model, 'selected').dropDownList({
                        0:"Нет",
                        1:"Promo",
                        2:"Выделять зелёным",
                    })|raw }}

                    {{ form.field(model, 'menu_hidden').dropDownList({
                        0:"Показать",
                        1:"Скрыть",
                    })|raw }}

                </div>
                <div class="col-md-12">


                    <h3>Локальная информация</h3>
                    <div class="tarif_select_blk">
                        <input type="radio" class="controls_option" value="ru-RU" checked id="option_tab_ru-RU"
                               name="tabs_open">
                        {% for k,lang in languages %}
                            <input type="radio" class="controls_option" value="{{ k }}" id="option_tab_{{ k }}"
                                   name="tabs_open">
                        {% endfor %}
                        <ul class="tab_control">
                            <li class="tab_butt_ru-RU">
                                <label for="option_tab_ru-RU">
                                    <img src="/images/flag/ru-RU.svg" height="12px">
                                    Русский
                                </label>
                            </li>
                            {% for k,lang in languages %}
                                <li class="tab_butt_{{ k }}">
                                    <label for="option_tab_{{ k }}">
                                        <img src="/images/flag/{{ k }}.svg" height="12px">
                                        {{ lang.name }}
                                    </label>
                                </li>
                            {% endfor %}
                        </ul>

                        <div class="content_tab">
                            <div class="cpa_box tab_ru-RU">
                                {{ form.field(model, 'name').textInput({'maxlength':true})|raw }}
                                {{ form.field(model, 'short_description').widget(TinyMce.className(),params('TinyMce'))|raw }}
                                {{ form.field(model, 'down_description').widget(TinyMce.className(),params('TinyMce'))|raw }}
                                {{ form.field(model, 'short_description_offline').widget(TinyMce.className(),params('TinyMce'))|raw }}
                                {{ form.field(model, 'down_description_offline').widget(TinyMce.className(),params('TinyMce'))|raw }}
                            </div>
                            {% for k,lang in languages %}
                                <div class="cpa_box tab_{{ k }}">
                                    {{ form.field(lang.model, 'name').textInput({'maxlength':true})|raw }}
                                    {{ form.field(lang.model, 'short_description').widget(TinyMce.className(),params('TinyMce'))|raw }}
                                    {{ form.field(lang.model, 'down_description').widget(TinyMce.className(),params('TinyMce'))|raw }}
                                    {{ form.field(lang.model, 'short_description_offline').widget(TinyMce.className(),params('TinyMce'))|raw }}
                                    {{ form.field(lang.model, 'down_description_offline').widget(TinyMce.className(),params('TinyMce'))|raw }}
                                </div>
                            {% endfor %}
                        </div>
                    </div>


                </div>

                <div class="col-md-12">
                    <input type="submit" value="{{ model.isNewRecord ? 'Create' : 'Update' }}" class="{{ model.isNewRecord ? "btn btn-success" : "btn btn-primary" }}">
                </div>
                {{ active_form_end() }}
            </div>
        </section>
        {% if model.isNewRecord == null and coupons_categories|length > 0 %}
            <section  class="account-padding view-list view-current">
                <div class="row">
                    <div class="col-md-12">
                        <p class="title">Категории купонов</p>
                    </div>
                    <div class="col-md-12">
                        <form method="post" action="/admin-categories/stores/update-coupon-categories?id={{ model.uid }}">
                            <ul class="ch_tree">
                                {% for category in coupons_categories %}
                                    <li>
                                        <label>
                                            <input {% if category.uid in model_coupon_categories %} checked {% endif %} data-uid="{{category.uid}}" type="checkbox" name="coupon_category_id[]" value="{{category.uid}}"><span>{{category.name}}</span>
                                        </label>
                                    </li>
                                {% endfor %}
                                <input type="hidden" name="id" value="{{model.uid}}">
                                <button type="submit">Изменить</button>
                            </ul>
                        </form>
                    </div>
                </div>
            </section>
        {% endif %}
    </div>
</div>
<style>
    ul.tab_control li label {
        cursor: pointer;
    }

    #option_tab_ru-RU:checked ~ ul .tab_butt_ru-RU {
        background: #fbcf4a;
    }

    #option_tab_ru-RU:checked ~ .content_tab .tab_ru-RU {
        display: block;
    }

    #option_tab_ru-RU:checked {
        color: #000;
    }

    {% for k,lang in languages %}
    #option_tab_{{ k }}:checked ~ ul .tab_butt_{{ k }} {
        background: #fbcf4a;
    }

    #option_tab_{{ k }}:checked ~ .content_tab .tab_{{ k }} {
        display: block;
    }

    #option_tab_{{ k }}:checked {
        color: #000;
    }

    {% endfor %}
</style>