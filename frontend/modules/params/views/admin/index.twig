{{ use('/yii/grid/GridView') }}
{% set title = 'Product Parameters' %}
{{ set(this, 'title', title) }}
{% if not this.params.breadcrumbs %}
{{ set(this, 'params', this.params|merge({'breadcrumbs': []})) }}
{% endif %}
{% set breadcrumbs = this.params.breadcrumbs %}
{% set breadcrumbs = breadcrumbs|merge([title]) %}
{{ set(this, 'params', this.params|merge({'breadcrumbs': breadcrumbs})) }}
<div class="product-parameters-index">
    <div class="content-wrapper">
        <section>
            <div class="row">
                <div class="col-md-12">
                    <h1>{{ html.encode(this.title) }}</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-md-10"></div>
                <div class="col-md-2">
                    <button class=" btn btn-primary" data-toggle="modal" data-target="#toolsModal" ><span class="fa fa-cogs"></span> Операции</button>
                </div>
            </div>
            <div class="row">
                <div  class="col-md-12">
                {{ grid_view_widget({
                        'id': 'grid-ajax-action',
                        'dataProvider': dataProvider,
                        'filterModel': searchModel,
                            'columns': [
                            {'class': '\\yii\\grid\\SerialColumn'},
                            {'class': '\\yii\\grid\\CheckboxColumn'},
                            'id',
                            {
                                'attribute': 'category_id',
                                'format': 'raw',
                                'value': tableData.categories,
                                'filter': product_categories,
                                'label': 'Категории',
                            },
                            {
                                'attribute':'code',
                                'format': 'raw',
                                'value': tableData.code,
                            },
                            'name',
                            {
                                'attribute':'synonym',
                                'format':'raw',
                                'filter':synonym_filter,
                                'value': tableData.synonym_name,
                            },
                            {
                                'attribute':'parameter_type',
                                'format': 'raw',
                                'value': tableData.type,
                                'filter': typeFilter
                            },
                            {
                                'attribute':'active',
                                'format': 'raw',
                                'value': tableData.active,
                                'filter': activeFilter
                            },

                            {
                                'attribute':'values',
                                'format': 'raw',
                                'value': tableData.values,
                                'label': 'Значения'
                            },

                            'created_at',
                            {'class': '\\yii\\grid\\ActionColumn', 'template': '{update}'},
                        ],
                    })
                }}
                </div>
            </div>
        </section>
    </div>
</div>
<div class="modal fade update-ajax " id="toolsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content ajax-action-content">
            <div class="modal-header">
                <span class="modal-title" id="exampleModalCenterTitle">Update selected Product Parameters</span>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="form-group">
                    <label for="tools-modal-active">Активен</label>
                    <select class="form-control"  name="active" id="tools-modal-active">
                        <option value="">Оставить без изменения</option>
                        {% for key, active in activeFilter %}
                            <option value="{{ key }}">{{ active }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group field-productparameters-category_id" {% if model.synonym %}style="display: none;"{% endif %}>
                    <label class="control-label" for="productparameters-category_id">Категория</label>
                    <input class="category_tree_input" id="productparameters-category_id" type="hidden"
                           name="category_id" value="" data-root="Корень"
                           data-refresh_url="admin/params/list" data-refresh_slave="productparameters-synonym" data-id="0"
                           data-slave_prompt="Оставить без изменения" />
                </div>

                <div class="form-group field-productparameters-synonym has-success">
                    <label class="control-label" for="productparameters-synonym">Является синонимом для</label>
                    <select id="productparameters-synonym"
                            class="form-control form-imput-depend-empty" name="synonym" data-depend-slave="productparameters-category_id," aria-invalid="false">
                        <option value="">Оставить без изменения</option>
                    </select>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                <a href="/admin/params/update-all"  class="btn btn-primary ajax-action" >Применить</a>
            </div>
        </div>
    </div>
</div>
<script>
    var category_data='{{ product_categories_data|raw }}';
</script>