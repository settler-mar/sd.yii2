<?php

use yii\db\Migration;
use frontend\modules\constants\models\Constants;

/**
 * Class m181001_130803_MakeMailConstants
 */
class m181001_130803_MakeMailConstants extends Migration
{
    /**
     * {@inheritdoc}
     */
    public function safeUp()
    {
        $this->execute('SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=\'TRADITIONAL,ALLOW_INVALID_DATES\';');
        $this->execute('SET SQL_MODE=\'ALLOW_INVALID_DATES\';');

        $const = new Constants();
        $const->name='mail_welcome';
        $const->title = 'Почта. Welcome';
        $const->text = '[{"subject":"SecretDiscounter: \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f","html":"<tr>\r\n  <td align=\"center\" valign=\"top\" width=\"100%\" style=\"background-color: #fff;text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px; padding: 20px 0 30px;\">\r\n    <center>\r\n      <table cellspacing=\"0\" cellpadding=\"0\" width=\"600\" style=\"border-collapse: collapse !important;\">\r\n        <tr>\r\n          <td style=\"text-align: center; font-family: Helvetica, Arial, sans-serif; border-collapse: collapse; font-size: 32px; font-weight: 700; line-height: normal; padding: 35px 0 25px; color: #4d4d4d;\">\r\n            \u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!\r\n          <\/td>\r\n        <\/tr>\r\n        <tr>\r\n          <td style=\"text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px; width: 100% !important; padding: 10px 60px 0px;\">\r\n            \u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c \u0432 \u043a\u044d\u0448\u0431\u044d\u043a-\u0441\u0435\u0440\u0432\u0438\u0441\u0435 SecretDiscounter. \u0422\u0435\u043f\u0435\u0440\u044c, \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u044f \u0438 \u043f\u043e\u043a\u0443\u043f\u0430\u044f \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430\u0445 \u0438\u0437 \u043d\u0430\u0448\u0435\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430, \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0447\u0430\u0441\u0442\u044c \u0434\u0435\u043d\u0435\u0433 \u043e\u0431\u0440\u0430\u0442\u043d\u043e - \u043a\u044d\u0448\u0431\u044d\u043a.\r\n            \u041f\u043e\u043c\u0438\u043c\u043e \u044d\u0442\u043e\u0433\u043e, \u0443 \u0432\u0430\u0441 \u043f\u043e\u044f\u0432\u0438\u043b\u0441\u044f \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0442\u044b\u0441\u044f\u0447\u0430\u043c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043a\u0443\u043f\u043e\u043d\u043e\u0432 \u0438 \u043f\u0440\u043e\u043c\u043e\u043a\u043e\u0434\u043e\u0432.\r\n            <br>\r\n            <br>\r\n            <span style=\"color: #4d4d4d; font-weight: bold; text-decoration: none;\">\u041b\u043e\u0433\u0438\u043d: {{user.email}}<\/span><br>\r\n            <span style=\"color: #4d4d4d; font-weight: bold;\">\u041f\u0430\u0440\u043e\u043b\u044c: {{user.new_password}}<\/span>\r\n            <br>\r\n            <br>\r\n            <br>\r\n            \u0422\u0430\u043a\u0436\u0435 \u0432\u0441\u0435\u043c \u043d\u043e\u0432\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u043c\u044b \u0434\u0430\u0440\u0438\u043c premium-\u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0430 10 \u0434\u043d\u0435\u0439, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0439 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043d\u0430 30% \u0431\u043e\u043b\u044c\u0448\u0435 \u043a\u044d\u0448\u0431\u044d\u043a\u0430.\r\n            <br>\r\n            \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e \u043d\u0430\u0448\u0435\u0439 \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 <a href=\"https:\/\/secretdiscounter.ru\/loyalty\">\u0447\u0438\u0442\u0430\u0439\u0442\u0435 \u0437\u0434\u0435\u0441\u044c<\/a>\r\n          <\/td>\r\n        <\/tr>\r\n        <tr>\r\n          <td style=\"text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px; padding: 30px 0;\">\r\n            <div><!--[if mso]>\r\n              <v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"https:\/\/secretdiscounter.ru\/account\" style=\"height:45px;v-text-anchor:middle;width:155px;\" arcsize=\"15%\" strokecolor=\"#0f181a\" fillcolor=\"#f7c714\">\r\n                <w:anchorlock\/>\r\n                <center style=\"color:#0f181a;font-family:Helvetica, Arial, sans-serif;font-size:14px;font-weight:regular;\">\u041c\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442<\/center>\r\n              <\/v:roundrect>\r\n              <![endif]--><a href=\"https:\/\/secretdiscounter.ru\/account\"\r\n                             style=\"background-color:#f7c714;border-radius:5px;color:#0f181a;display:inline-block;font-family:\'Cabin\', Helvetica, Arial, sans-serif;font-size:14px;font-weight:regular;line-height:45px;text-align:center;text-decoration:none;width:155px;-webkit-text-size-adjust:none;mso-hide:all;\" target=\"_blank\"><span  style=\"background-color:#f7c714;border-radius:5px;color:#0f181a;display:inline-block;font-family:\'Cabin\', Helvetica, Arial, sans-serif;font-size:14px;font-weight:regular;line-height:45px;text-align:center;text-decoration:none;width:155px;-webkit-text-size-adjust:none;mso-hide:all;\">\u041c\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442<\/span><\/a><\/div>\r\n          <\/td>\r\n        <\/tr>\r\n      <\/table>\r\n    <\/center>\r\n  <\/td>\r\n<\/tr>\r\n\r\n<tr>\r\n  <td align=\"center\" valign=\"top\" width=\"100%\" style=\"background-color: #ffffff;  border-top: 1px solid #e5e5e5; border-bottom: 1px solid #e5e5e5; text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n    <center>\r\n      <table cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse !important;\" width=\"100%\">\r\n        <tr>\r\n          <td style=\"text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px; padding: 20px 0 30px;\">\r\n            <table cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse !important;\" width=\"100%\">\r\n              <tr>\r\n                <td style=\"text-align: center; font-family: Helvetica, Arial, sans-serif; border-collapse: collapse; font-size: 24px; font-weight: 700; line-height: normal; padding: 35px 0 0; color: #4d4d4d;\">\r\n                  \u041d\u0430\u0448\u0438 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0412\u0430\u0441!\r\n                <\/td>\r\n              <\/tr>\r\n            <\/table>\r\n          <\/td>\r\n        <\/tr>\r\n        <tr>\r\n          <td style=\"padding-bottom: 75px; text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n            <table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"border-collapse:separate !important;\">\r\n              <tr>\r\n                    <td\r\n                      style=\"text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px; padding: 0 20px; width: 100%;\">\r\n\r\n        {% for store in stores %}\r\n                      <table cellpadding=\"0\" cellspacing=\"0\" width=\"240px\" style=\"border-collapse:separate !important; margin: 15px; display:inline-block\">\r\n                        <tr>\r\n                          <td\r\n                            style=\"width: 240px; border-radius: 5px;border: 1px solid #e5e5e5;vertical-align: top; text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n                            <table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"\r\n                                   style=\'border-collapse: collapse !important;\'>\r\n                              <tr>\r\n                                <td\r\n                                  style=\"padding: 10px !important;border-radius: 5px 5px 0 0; text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n                                  <a href=\"https:\/\/secretdiscounter.ru\/stores\/{{store.route}}\"\r\n                                     style=\"color: #676767; text-decoration: none !important;\" target=\"_blank\">\r\n                                    <img\r\n                                      style=\"padding: 10px !important;border-radius: 5px 5px 0 0;border: 0px;\"\r\n                                      src=\"https:\/\/secretdiscounter.ru\/images\/logos\/{{store.logo}}\"\r\n                                      alt=\"{{store.name}}\"\/>\r\n                                  <\/a>\r\n                                <\/td>\r\n                              <\/tr>\r\n                              <tr>\r\n                                <td\r\n                                  style=\"padding: 15px; text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n                                  <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\"\r\n                                         style=\"border-collapse: collapse !important;\">\r\n                                    <tr>\r\n                                      <td\r\n                                        style=\"text-align:left; width:155px; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n                                        <a href=\"https:\/\/secretdiscounter.ru\/stores\/{{store.route}}>\"\r\n                                           style=\"text-decoration: none !important; padding: 5px 0; font-size: 18px; line-height: 1.3; color: #4d4d4d; font-weight: 700;\"\r\n                                           target=\"_blank\"><span\r\n                                            style=\"text-decoration: none !important; padding: 5px 0; font-size: 18px; line-height: 1.3; color: #4d4d4d; font-weight: 700;word-wrap: break-word;width: 155px;max-height:46px;display: block;overflow: hidden\">{{store.name}}<\/span><\/a><br\/>\r\n\r\n                                      <\/td>\r\n                                      <td\r\n                                        style=\"text-align:right; vertical-align: top; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n                                        <strong>{{ cashback(store,\'shop_catalog\')|raw }}<\/strong>\r\n                                      <\/td>\r\n                                    <\/tr>\r\n                                  <\/table>\r\n                                <\/td>\r\n                              <\/tr>\r\n                              <tr>\r\n                                <td\r\n                                  style=\"padding: 15px; text-align: center; font-family: Helvetica, Arial, sans-serif; font-size: 14px; color: #777777; border-collapse: collapse; line-height: 21px;\">\r\n                                  <div><!--[if mso]>\r\n                                    <v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\"\r\n                                                 xmlns:w=\"urn:schemas-microsoft-com:office:word\"\r\n                                                 href=\"https:\/\/secretdiscounter.ru\/stores\/<?=$store[\'route\'];?>\"\r\n                                                 style=\"height:45px;v-text-anchor:middle;width:228px;\" arcsize=\"15%\"\r\n                                                 strokecolor=\"#0f181a\" fillcolor=\"#f7c714\">\r\n                                      <w:anchorlock\/>\r\n                                      <center\r\n                                        style=\"color:#0f181a;font-family:Helvetica, Arial, sans-serif;font-size:14px;font-weight:regular;\">\r\n                                        \u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\r\n                                      <\/center>\r\n                                    <\/v:roundrect>\r\n                                    <![endif]--><a href=\"https:\/\/secretdiscounter.ru\/stores\/{{store.route}}\"\r\n                                                   style=\"width: 200px; background-color:#f7c714;border-radius:5px;color:#0f181a;display:inline-block;font-family:\'Cabin\', Helvetica, Arial, sans-serif;font-size:14px;font-weight:regular;line-height:45px;text-align:center;text-decoration:none;-webkit-text-size-adjust:none;mso-hide:all\"\r\n                                                   target=\"_blank\"><span\r\n                                        style=\"width: 200px; background-color:#f7c714;border-radius:5px;color:#0f181a;display:inline-block;font-family:\'Cabin\', Helvetica, Arial, sans-serif;font-size:14px;font-weight:regular;line-height:45px;text-align:center;text-decoration:none;-webkit-text-size-adjust:none;mso-hide:all\">\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d<\/span><\/a>\r\n                                  <\/div>\r\n                                <\/td>\r\n                              <\/tr>\r\n                            <\/table>\r\n                          <\/td>\r\n                        <\/tr>\r\n                      <\/table>\r\n                        {% endfor %}\r\n\r\n                    <\/td>\r\n              <\/tr>\r\n            <\/table>\r\n          <\/td>\r\n        <\/tr>\r\n      <\/table>\r\n    <\/center>\r\n  <\/td>\r\n<\/tr>","txt":"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c \u0432 \u043a\u044d\u0448\u0431\u044d\u043a-\u0441\u0435\u0440\u0432\u0438\u0441\u0435 SecretDiscounter. \u0422\u0435\u043f\u0435\u0440\u044c, \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u044f \u0438 \u043f\u043e\u043a\u0443\u043f\u0430\u044f \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430\u0445 \u0438\u0437 \u043d\u0430\u0448\u0435\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430, \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0447\u0430\u0441\u0442\u044c \u0434\u0435\u043d\u0435\u0433 \u043e\u0431\u0440\u0430\u0442\u043d\u043e - \u043a\u044d\u0448\u0431\u044d\u043a.\r\n\u041f\u043e\u043c\u0438\u043c\u043e \u044d\u0442\u043e\u0433\u043e, \u0443 \u0432\u0430\u0441 \u043f\u043e\u044f\u0432\u0438\u043b\u0441\u044f \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0442\u044b\u0441\u044f\u0447\u0430\u043c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043a\u0443\u043f\u043e\u043d\u043e\u0432 \u0438 \u043f\u0440\u043e\u043c\u043e\u043a\u043e\u0434\u043e\u0432.\r\n\r\n\u041b\u043e\u0433\u0438\u043d: {{user.email}}\r\n\u041f\u0430\u0440\u043e\u043b\u044c: {{user.new_password}}\r\n\r\n\u0422\u0430\u043a\u0436\u0435 \u0432\u0441\u0435\u043c \u043d\u043e\u0432\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u043c\u044b \u0434\u0430\u0440\u0438\u043c premium-\u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0430 10 \u0434\u043d\u0435\u0439, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0439 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043d\u0430 30% \u0431\u043e\u043b\u044c\u0448\u0435 \u043a\u044d\u0448\u0431\u044d\u043a\u0430.\r\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e \u043d\u0430\u0448\u0435\u0439 \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0447\u0438\u0442\u0430\u0439\u0442\u0435 \u0437\u0434\u0435\u0441\u044c (https:\/\/secretdiscounter.ru\/loyalty)"}]';
        $const->editor_param = 'mail';
        $const->ftype = 'json';
        $const->category = 8;
        $const->save();
    }

    /**
     * {@inheritdoc}
     */
    public function safeDown()
    {
        $this->execute('SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=\'TRADITIONAL,ALLOW_INVALID_DATES\';');
        $this->execute('SET SQL_MODE=\'ALLOW_INVALID_DATES\';');

        Constants::deleteAll(['name' => ['mail_welcome']]);
    }

    /*
    // Use up()/down() to run migration code without a transaction.
    public function up()
    {

    }

    public function down()
    {
        echo "m181001_130803_MakeMailConstants cannot be reverted.\n";

        return false;
    }
    */
}
